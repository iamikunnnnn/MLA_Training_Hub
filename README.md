# 一、传统机器学习训练平台

基于 **Streamlit** 构建的一站式传统机器学习实验平台，支持从数据上传、预处理、模型训练到结果可视化与模型保存的全流程操作。平台覆盖主流机器学习算法（如KNN、决策树、随机森林等），提供可视化交互界面，降低传统机器学习的实践门槛。

## 目录

- [项目概述](#项目概述)
- [核心功能](#核心功能)
- [技术栈](#技术栈)
- [安装指南](#安装指南)
- [使用手册](#使用手册)
  - [1. 数据读取模块](#1-数据读取模块)
  - [2. 数据预处理模块](#2-数据预处理模块)
  - [3. 模型训练模块](#3-模型训练模块)
  - [4. 模型保存模块](#4-模型保存模块)
- [项目结构](#项目结构)
- [注意事项](#注意事项)

## 项目概述

本平台聚焦传统机器学习的全流程实践，通过可视化界面将“数据处理→模型构建→训练评估→模型保存”的技术链路模块化、交互化。用户无需编写复杂代码，即可完成以下操作：

1. 上传CSV/TXT格式数据集，快速查看数据基本信息；
2. 针对性处理数据问题（空值、重复值、非数值编码）；
3. 选择分类/回归任务，配置模型参数并启动训练；
4. 可视化训练结果（如决策边界、真实值vs预测值）；
5. 保存训练好的模型，支持本地下载复用。

## 核心功能

| 功能模块   | 具体能力                                                                                                 |
| ---------- | -------------------------------------------------------------------------------------------------------- |
| 数据读取   | 支持多文件上传（CSV/TXT），自动加载数据并展示样本，缓存数据避免重复读取                                  |
| 数据预处理 | 3大核心能力：<br>- 空值处理（删除空值行/均值填充/删除列）<br>- 重复值删除<br>- 编码（独热编码/标签编码） |
| 模型训练   | 支持分类/回归双模式，覆盖6类主流算法，可自定义参数、测试集占比，训练后输出评估指标                       |
| 结果可视化 | 分类任务：决策边界绘制<br>回归任务：真实值vs预测值、拟合曲线<br>决策树：树结构可视化                     |
| 模型保存   | 记录所有训练完成的模型，支持多模型批量选择与本地下载（PKL格式）                                          |

## 技术栈

| 类别         | 技术/库名称                          | 用途说明                                                                   |
| ------------ | ------------------------------------ | -------------------------------------------------------------------------- |
| 前端框架     | Streamlit                            | 构建交互式Web界面，实现标签页、按钮、下拉框等组件与数据联动                |
| 数据处理     | Pandas                               | 数据集加载、清洗、格式转换（如空值统计、重复值删除）                       |
| 机器学习框架 | Scikit-learn（隐含于Traditional_ML） | 提供KNN、决策树、随机森林等传统ML算法，以及数据划分、评估指标计算能力      |
| 可视化工具   | Matplotlib                           | 绘制空值分布柱状图、决策边界、真实值vs预测值等图表                         |
| 数据存储     | Pickle / SQLite3                     | Pickle用于模型序列化保存，SQLite3用于潜在的数据集/模型元数据持久化（预留） |
| 辅助工具     | UUID                                 | 生成唯一标识，解决Streamlit组件重复渲染的Key冲突问题                       |

## 安装指南

### 1. 环境要求

- Python 3.8+
- 依赖库：`streamlit`、`pandas`、`matplotlib`、`scikit-learn`（隐含于 `Traditional_ML`模块）、`pickle`（Python内置）、`sqlite3`（Python内置）、`uuid`（Python内置）

### 2. 安装步骤

1. 克隆或下载项目代码到本地目录；
2. 打开终端，进入项目根目录，执行以下命令安装依赖：
   ```bash
   pip install -r requirements.txt

   ```

（若未提供 `requirements.txt`，可直接执行：`pip install streamlit pandas matplotlib scikit-learn`）

3. 安装完成后，执行启动命令（替换为实际主程序文件名，如 `ml_main.py`）：

```bash
streamlit run 主程序文件名.py
```

1. 终端输出 “Local URL” 后，在浏览器中打开对应链接（通常为 `http://localhost:8501`），即可使用平台。

## 使用手册

### 1. 数据读取模块

1. 在左侧侧边栏 “选择页面” 中点击「数据读取」；
2. 点击「请选择上传数据」按钮，选择 1 个或多个 CSV/TXT 格式的数据集文件；
3. 上传完成后，平台会自动加载数据，按文件分别展示「文件名称」和「前 5 行数据样本」；
4. 加载的数据会自动存入 `st.session_state["df"]`，供后续预处理模块调用。

> 提示：平台使用 `@st.cache_data`缓存数据，避免重复上传时重新加载，提升效率。

### 2. 数据预处理模块

#### 2.1 数据基本信息查看

进入「数据预处理」页面后，平台会自动加载已上传的数据，并展示以下信息（通过多选项可自定义展示内容）：

- **数据形状**：展示数据的行数、列数；
- **空值统计**：柱状图展示每列的空值数量，柱子上标注具体数值；
- **重复行数量**：柱状图展示数据集中重复行的总数；
- **数据样本**：展示完整的数据集（折叠式面板，点击展开）。

#### 2.2 列选择模式

先选择 “单列操作” 或 “多列操作”，确定需要处理的列：

- **单列**：下拉选择单个列或 “全部”（即所有列）；
- **多列**：勾选多个需要处理的列（支持批量选择）。

#### 2.3 核心预处理操作（三大标签页）

##### 标签页 1：数据去空

提供 3 种空值处理方式，选择对应子标签页后点击「开始去空」：

- **删除空值行**：删除所选列中包含空值的所有行；
- **插入均值**：用所选列的均值填充该列中的空值（仅对数值型列有效）；
- **删除列**：直接删除所选的列（适用于空值占比极高的列）。

##### 标签页 2：数据去重

仅 1 种操作，点击「开始去重」：

- 删除所选列中完全重复的行（若选择多列，需多列值完全一致才判定为重复）。

##### 标签页 3：数据编码

针对非数值型列（如字符串类别），提供 2 种编码方式：

- **独热编码**：点击「开始处理选择的非数值列」，将类别列转换为多个 0/1 编码列；
- **标签编码**：点击「开始编码选择的列」，将类别列转换为连续的整数（如 A→0、B→1）。

> 提示：每完成一次预处理操作，平台会自动更新 `st.session_state["df"]`，并重新展示处理后的数据基本信息，方便验证效果。

### 3. 模型训练模块

#### 3.1 基础配置

1. **任务模式选择**：下拉选择「回归」或「分类」（决定后续可选模型列表）；
2. 模型选择：
   - 回归模式：KNN、线性回归、决策树、随机森林、梯度提升树、支持向量机；
   - 分类模式：KNN、逻辑回归、决策树、随机森林、梯度提升树、支持向量机；
3. 特征与目标列选择：
   - 目标列（y）：下拉选择 1 列作为模型预测的目标；
   - 特征列（X）：勾选多个列作为模型的输入特征（默认排除目标列）；
4. 数据划分参数：
   - 测试集占比：输入 0-1 之间的数值（默认 0.2，即 20% 数据作为测试集）；
   - random_state：输入整数（默认 42，确保数据划分结果可复现）。

#### 3.2 模型参数自定义

1. 平台会自动加载所选模型的可配置参数（如 KNN 的 `n_neighbors`、决策树的 `max_depth`）；
2. 勾选「选择要调整的参数」，针对每个参数：
   - 选择型参数（如 `solver`）：下拉选择可选值；
   - 整数型参数（如 `n_estimators`）：输入整数；
   - 浮点型参数（如 `learning_rate`）：输入小数；
   - 布尔型参数（如 `verbose`）：勾选启用 / 禁用；
3. 配置完成后，平台会实时展示「当前参数值」，确认无误后点击「开始训练」。

#### 3.3 训练与评估

1. 点击「开始训练」后，平台会输出训练状态（“训练中，请等待”→“训练完成，正在评估”）；
2. 训练完成后，自动输出评估结果：
   - 模型名称（如 “KNeighborsRegressor”）；
   - 评估指标（回归：MAE、MSE、R²；分类：准确率、Precision、Recall、F1）。

#### 3.4 结果可视化

根据任务模式和模型类型，可点击对应按钮绘制图表：

- 回归任务：
  - 「绘制真实值 vs 预测值」：散点图展示测试集真实值与模型预测值的对应关系；
  - 「绘制预测值拟合真实值图像」：折线图展示拟合曲线与真实值分布；
- 分类任务：
  - 「绘制决策边界」：二维散点图展示数据分布与模型的决策边界（仅支持 2 个特征时生效）；
- 决策树模型：
  - 「进行树可视化」：绘制决策树的结构（节点分裂条件、样本数量、纯度指标）。

### 4. 模型保存模块

1. 进入「模型保存」页面后，平台会自动展示「已保存的模型列表」（包含模型序号和名称）；
2. 若未保存任何模型，会提示 “还没有保存任何模型”，需先在「模型训练」模块完成训练；
3. 勾选「选择需要保存的模型」（支持多选）；
4. 每个选中的模型会生成「下载 模型名」按钮，点击即可下载 PKL 格式的模型文件（可用于后续预测复用）。

## 项目结构

```plaintext
项目根目录/
│Traditional_ML/         # 传统机器学习核心模块目录
│   ├── UI.py          # 主程序入口
│   ├── __init__.py
│   ├── model.py            # 模型选择、训练、评估逻辑
│   ├── data_preprocessing.py # 数据预处理类
│   └── param.py            # 参数配置
└── requirements.txt        # 项目依赖库列表
```

## 注意事项

1. **数据格式要求**：仅支持 CSV/TXT 格式，建议确保数据第一行为列名，数值型列无字符串干扰（否则训练时会提示 “数据存在字符串，请预处理”）；
2. **参数配置合理性**：部分参数需符合逻辑（如测试集占比需在 0-1 之间、KNN 的 `n_neighbors`需为正整数），否则会触发报错；
3. **决策边界绘制限制**：仅当特征列（X）选择 2 列时，分类任务的「绘制决策边界」功能才生效（高维特征无法可视化）；
4. **模型下载与复用**：下载的 PKL 模型文件可通过 `pickle.load()`加载，复用前需确保输入特征的格式与训练时一致（如编码方式、特征数量）；
5. **SessionState 清理**：若需重新上传数据或更换模型，建议刷新页面清空 `st.session_state`，避免历史数据干扰。

# 二深度学习可视化平台

一个基于 **Streamlit** 构建的用户友好型交互式平台，用于可视化和学习深度学习核心概念。平台涵盖理论知识讲解、回归拟合演示、分类效果展示及可自定义神经网络训练功能，通过实时动态可视化帮助用户直观理解深度学习核心机制。

## 目录

- [项目概述](#项目概述)
- [核心功能](#核心功能)
- [技术栈](#技术栈)
- [安装指南](#安装指南)
- [使用手册](#使用手册)
  - [1. 理论学习模块](#1-理论学习模块)
  - [2. 回归拟合效果演示](#2-回归拟合效果演示)
  - [3. 分类效果演示](#3-分类效果演示)
  - [4. 神经网络训练演示](#4-神经网络训练演示)
- [项目结构](#项目结构)
- [注意事项](#注意事项)

## 项目概述

本平台旨在降低深度学习的理解门槛，将**理论讲解**、**算法可视化**与**交互式实验**整合到统一界面中。用户可通过平台完成以下操作：

1. 系统学习深度学习基础知识（基本概念、训练流程、激活函数原理）；
2. 观察回归模型实时收敛过程（支持“无激活函数”“Sigmoid激活函数”两种模式）；
3. 查看分类模型动态训练过程及最终评估指标（准确率Accuracy、F1分数）；
4. 自定义神经网络参数（如网络架构、优化器、学习率调度器等），并实时观察训练效果。

## 核心功能

| 功能模块             | 具体能力                                                                 |
| -------------------- | ------------------------------------------------------------------------ |
| 理论学习             | 分模块讲解“基本知识”“基本流程”“激活函数”，支持查看核心算法代码     |
| 回归拟合演示         | 选择激活函数后一键启动拟合，实时展示模型迭代过程，支持查看实现代码       |
| 分类效果演示         | 一键启动分类训练，动态展示决策边界变化，训练结束后输出Accuracy和F1指标   |
| 神经网络训练（高级） | 支持自定义数据集、网络架构、训练参数、正则化策略，支持模型保存与内存释放 |

## 技术栈

| 类别         | 技术/库名称 | 用途说明                                                     |
| ------------ | ----------- | ------------------------------------------------------------ |
| 前端框架     | Streamlit   | 构建交互式Web界面，实现组件渲染与实时更新                    |
| 数据处理     | NumPy       | 生成与处理实验数据（如回归样本、分类样本）                   |
| 深度学习框架 | PyTorch     | 构建神经网络模型，实现训练逻辑（优化器、损失计算、参数更新） |
| 可视化工具   | Matplotlib  | 绘制模型训练过程中的拟合曲线、决策边界、损失变化等图表       |
| 辅助工具     | Tkinter     | 提供文件选择功能（隐藏主窗口，仅用于后台文件操作）           |

## 安装指南

### 1. 环境要求

- Python 3.8+
- 依赖库：`streamlit`、`numpy`、`torch`、`matplotlib`、`tkinter`（通常随Python默认安装）

### 2. 安装步骤

1. 克隆或下载项目代码到本地目录；
2. 打开终端，进入项目根目录，执行以下命令安装依赖：
   ```bash
   pip install -r requirements.txt

   ```

（若未提供 `requirements.txt`，可直接执行：`pip install streamlit numpy torch matplotlib`）

3. 安装完成后，执行启动命令：

```bash
streamlit run 主程序文件名.py  # 替换为实际的主程序文件名（如main.py）
```

1. 终端输出 “Local URL” 后，在浏览器中打开对应链接（通常为 `http://localhost:8501`），即可使用平台。

## 使用手册

### 1. 理论学习模块

1. 在左侧侧边栏的 “选择页面” 中点击「理论学习」；
2. 在 “请选择你想要了解的知识” 下拉框中，选择目标学习内容（以 “激活函数” 为例）；
3. 页面将展示对应模块的理论讲解内容；
4. 若需查看代码，可在其他模块（如回归 / 分类演示）中点击「显示代码」按钮。

### 2. 回归拟合效果演示

1. 在侧边栏 “选择页面” 中点击「回归拟合效果展示」；
2. 在 “请选择激活函数” 下拉框中选择模式（“无” 或 “sigmoid”）；
3. 点击「开始拟合」按钮，页面将实时展示模型迭代过程（拟合曲线逐步逼近真实数据）；
4. 若需查看实现逻辑，点击「显示代码」按钮，页面将展示回归拟合的核心代码（含注释）。

### 3. 分类效果演示

1. 在侧边栏 “选择页面” 中点击「分类效果展示」；
2. 点击「开始分类」按钮，页面将动态展示分类模型的决策边界变化；
3. 训练结束后，页面将自动输出最终的分类效果图、准确率（Acc）和 F1 分数；
4. 点击「显示代码」按钮，可查看分类模型的训练代码（含数据生成、模型构建、损失计算逻辑）。

### 4. 神经网络训练演示

#### 4.1 基础参数配置（侧边栏）

| 参数类别   | 配置说明                                                              |
| ---------- | --------------------------------------------------------------------- |
| 数据集选择 | 支持 “分类”“圆形”“月形”“自定义”“回归”“回归 2.0”6 种数据集 |
| 衍生特征   | 可勾选 “平方项”“交叉项”“正弦项”“余弦项”，扩展特征维度         |
| 数据量     | 滑动条调整（100~5000，步长 100）                                      |
| 网络架构   | 配置 “隐藏层数”（1~4 层）及每一层的 “神经元数”（2~8 个）         |
| 训练参数   | 学习率（0.001~1.0）、训练轮数（100~10000）、批次大小（1/8/16/32/64） |
| 优化器     | 支持 “SGD”“Adam”“RMSprop”“Nesterov”“SGD with Momentum”      |

#### 4.2 高级配置（侧边栏）

1. **学习率调度器**：
   - 支持 “StepLR”“MultiStepLR”“ExponentialLR”“CosineAnnealingLR”“ReduceLROnPlateau”“无” 6 种模式；
   - 选择对应调度器后，可配置专属参数（如 StepLR 的 “步长”“衰减系数”，ReduceLROnPlateau 的 “耐心值”“最小学习率”）。
2. **正则化策略**：
   - 可勾选 “dropout”“L2” 两种正则化方式；
   - 勾选后可调整 “dropout 概率”（0.0~0.5）或 “L2 正则化力度”（0.0001~0.01）。

#### 4.3 训练操作

1. 配置完成后，点击「开始训练」按钮，页面将分两栏展示训练过程：
   - 左栏：模型损失变化、参数分布等；
   - 右栏：数据分布与模型决策边界（分类任务）或拟合曲线（回归任务）；
2. 训练过程中可点击「停止训练」按钮终止当前训练；
3. 训练结束后，若需保存模型，点击「保存模型」按钮，再通过「下载模型」获取 `model_final.pth`文件；
4. 若需释放内存，点击「释放上一个模型内存模型」按钮（仅训练停止后可用）。

## 项目结构

```plaintext
项目根目录/
├── UI.py                # 主程序入口（含界面路由、组件渲染逻辑）
├── Deep_Learning/         # 深度学习核心模块目录
│   ├── __init__.py
│   ├── page1_Knowledge.py # 理论知识的存储，如基础概念）
│   ├── page2.py           # 回归拟合核心逻辑（数据生成、模型训练、可视化）
│   ├── page3.py           # 分类效果核心逻辑（数据生成、决策边界计算）
│   └── page4_train_nn.py  # 神经网络训练类（含参数解析、训练循环、
	└── page4_model_viz.py  # 神经网络结果可视化类
	└── page4_get_data.py  # 创建数据
模型保存）
└── requirements.txt       # 项目依赖库列表
```

## 注意事项

1. **内存管理**：神经网络训练完成后，建议点击「释放上一个模型内存模型」按钮，避免 GPU/CPU 内存占用过高；
2. **自定义数据集**：选择 “自定义” 数据集时，需确保数据格式与模型要求匹配（具体格式可参考 `page4_train_nn.py`中的数据加载逻辑）；
3. **学习率设置**：学习率过大会导致模型不收敛，过小会导致训练速度缓慢，建议分类任务默认使用 0.01，回归任务默认使用 0.001；
4. **可视化速度**：若训练过程中可视化卡顿，可适当增大 `time.sleep(0.01)`中的数值（在 `main.py`的拟合 / 训练循环中调整）；
5. **环境兼容**：若使用 GPU 训练，需确保 PyTorch 已配置 CUDA 环境（可通过 `torch.cuda.is_available()`验证）。
